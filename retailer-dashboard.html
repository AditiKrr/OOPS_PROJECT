<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retailer Dashboard - Live Mart</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" integrity="sha512-Zcn6bjR/8RZbLEpLIeOwNtzREBAJnUKESxces60Mpoj+2okopSAcSUIUOseddDm0cxnGQzxIR7vJgsLZbdLE3w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
    <!-- Dashboard Navigation -->
    <nav class="dashboard-nav">
        <div class="container">
            <div class="nav-wrapper">
                <a href="index.html" class="logo" style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-shopping-cart"></i>
                    <span>Live Mart</span>
                    <span id="navPincode" class="pincode-badge">Loading...</span>
                    <span class="role-badge retailer">Retailer</span>
                </a>
                <div class="user-info">
                    <span class="user-name">Welcome, Jane Smith</span>
                    <div class="user-menu">
                        <img src="https://ui-avatars.com/api/?name=Jane+Smith&background=10b981&color=fff" alt="User" class="user-avatar">
                        <div class="dropdown-menu">
                            <a href="#profile"><i class="fas fa-user"></i> Profile</a>
                            <a href="#settings"><i class="fas fa-cog"></i> Settings</a>
                            <a href="#" onclick="handleDashboardLogout(); return false;"><i class="fas fa-sign-out-alt"></i> Logout</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <ul class="sidebar-menu">
                <li class="active" data-section="overview">
                    <i class="fas fa-chart-line"></i>
                    <span>Overview</span>
                </li>
                <li data-section="inventory">
                    <i class="fas fa-boxes"></i>
                    <span>Manage Inventory</span>
                </li>
                <li data-section="pricing">
                    <i class="fas fa-tag"></i>
                    <span>Pricing</span>
                </li>
                <li data-section="customers">
                    <i class="fas fa-users"></i>
                    <span>Customer History</span>
                </li>
                <li data-section="wholesale-orders">
                    <i class="fas fa-truck"></i>
                    <span>Wholesaler Orders</span>
                </li>
                <li data-section="queries">
                    <i class="fas fa-question-circle"></i>
                    <span>Customer Queries</span>
                </li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Overview Section -->
            <section id="overview" class="dashboard-section active">
                <div class="section-header">
                    <h1>Dashboard Overview</h1>
                    <p>Your business performance at a glance</p>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon blue">
                            <i class="fas fa-shopping-bag"></i>
                        </div>
                        <div class="stat-info">
                            <h3>156</h3>
                            <p>Total Orders</p>
                            <span class="stat-change positive">+12% this month</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon green">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <div class="stat-info">
                            <h3>â‚¹10,19,140</h3>
                            <p>Revenue</p>
                            <span class="stat-change positive">+8% this month</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon orange">
                            <i class="fas fa-box"></i>
                        </div>
                        <div class="stat-info">
                            <h3>342</h3>
                            <p>Products</p>
                            <span class="stat-change">24 low stock</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon purple">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <h3>89</h3>
                            <p>Active Customers</p>
                            <span class="stat-change positive">+5 this week</span>
                        </div>
                    </div>
                </div>

                <div class="charts-container">
                    <div class="chart-card">
                        <h3>Sales Overview</h3>
                        <div class="chart-placeholder">
                            <canvas id="salesChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <h3>Top Products</h3>
                        <div class="top-products-list" id="topProductsList">
                            <!-- Top products will be loaded here -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Inventory Management Section -->
            <section id="inventory" class="dashboard-section">
                <div class="section-header">
                    <h1>Manage Inventory</h1>
                    <p>Add, update, or remove products from your catalog</p>
                    <button class="btn btn-primary" id="addItemBtn">
                        <i class="fas fa-plus"></i> Add New Item
                    </button>
                </div>

                <div class="inventory-filters">
                    <input type="text" id="inventorySearch" placeholder="Search inventory...">
                    <select id="inventoryCategory" class="filter-select">
                        <option value="">All Categories</option>
                        <option value="electronics">Electronics</option>
                        <option value="groceries">Groceries</option>
                        <option value="clothing">Clothing</option>
                        <option value="home">Home & Garden</option>
                    </select>
                    <select id="inventoryStock" class="filter-select">
                        <option value="">All Stock Levels</option>
                        <option value="in-stock">In Stock</option>
                        <option value="low-stock">Low Stock</option>
                        <option value="out-of-stock">Out of Stock</option>
                    </select>
                </div>

                <div class="inventory-table-container">
                    <table class="inventory-table">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>SKU</th>
                                <th>Category</th>
                                <th>Stock</th>
                                <th>Price</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="inventoryTableBody">
                            <!-- Inventory items will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Pricing Section -->
            <section id="pricing" class="dashboard-section">
                <div class="section-header">
                    <h1>Pricing Management</h1>
                    <p>Set and adjust product prices</p>
                </div>

                <div class="pricing-tools">
                    <button class="btn btn-secondary" id="bulkPricingBtn">
                        <i class="fas fa-percentage"></i> Bulk Pricing Update
                    </button>
                    <button class="btn btn-secondary" id="discountBtn">
                        <i class="fas fa-tags"></i> Apply Discount
                    </button>
                </div>

                <div class="pricing-table-container">
                    <table class="pricing-table">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Cost Price</th>
                                <th>Selling Price</th>
                                <th>Margin</th>
                                <th>Discount</th>
                                <th>Final Price</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="pricingTableBody">
                            <!-- Pricing items will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Customer History Section -->
            <section id="customers" class="dashboard-section">
                <div class="section-header">
                    <h1>Customer Purchase History</h1>
                    <p>Track and analyze customer transactions</p>
                </div>

                <div class="customer-search">
                    <input type="text" id="customerSearch" placeholder="Search by customer name, email, or order ID...">
                    <button class="btn btn-primary">
                        <i class="fas fa-search"></i> Search
                    </button>
                </div>

                <div class="customers-list" id="customersList">
                    <!-- Customer records will be loaded here -->
                </div>
            </section>

            <!-- Wholesaler Orders Section -->
            <section id="wholesale-orders" class="dashboard-section">
                <div class="section-header">
                    <h1>Orders from Wholesalers</h1>
                    <p>Place and manage orders with your suppliers</p>
                    <button class="btn btn-primary" id="newWholesaleOrderBtn">
                        <i class="fas fa-plus"></i> New Order
                    </button>
                </div>

                <div class="orders-tabs">
                    <button class="tab-btn active" data-tab="pending">Pending</button>
                    <button class="tab-btn" data-tab="confirmed">Confirmed</button>
                    <button class="tab-btn" data-tab="shipped">Shipped</button>
                    <button class="tab-btn" data-tab="delivered">Delivered</button>
                </div>

                <div class="wholesale-orders-list" id="wholesaleOrdersList">
                    <!-- Wholesale orders will be loaded here -->
                </div>
            </section>

            <!-- Customer Queries Section -->
            <section id="queries" class="dashboard-section">
                <div class="section-header">
                    <h1>Customer Queries</h1>
                    <p>Respond to customer questions and concerns</p>
                </div>

                <div class="queries-filters">
                    <button class="filter-btn active" data-status="all">All</button>
                    <button class="filter-btn" data-status="open">Open</button>
                    <button class="filter-btn" data-status="pending">Pending</button>
                    <button class="filter-btn" data-status="resolved">Resolved</button>
                </div>

                <div class="queries-list" id="queriesList">
                    <!-- Customer queries will be loaded here -->
                </div>
            </section>
        </main>
    </div>

    <!-- Add/Edit Item Modal -->
    <div id="itemModal" class="modal">
        <div class="modal-content large">
            <span class="modal-close">&times;</span>
            <div class="modal-body">
                <h2 id="modalTitle">Add New Item</h2>
                <form id="itemForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Product Name</label>
                            <input type="text" id="itemName" required>
                        </div>
                        <div class="form-group">
                            <label>SKU</label>
                            <input type="text" id="itemSku" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Category</label>
                            <select id="itemCategory" required>
                                <option value="">Select category...</option>
                                <option value="electronics">Electronics</option>
                                <option value="groceries">Groceries</option>
                                <option value="clothing">Clothing</option>
                                <option value="home">Home & Garden</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Stock Quantity</label>
                            <input type="number" id="itemStock" required min="0">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Cost Price</label>
                            <input type="number" id="itemCost" required min="0" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Selling Price</label>
                            <input type="number" id="itemPrice" required min="0" step="0.01">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="itemDescription" rows="4"></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" id="cancelBtn">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save Item</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Query Response Modal -->
    <div id="queryModal" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <div class="modal-body">
                <h2>Respond to Query</h2>
                <div id="queryDetails"></div>
                <form id="queryResponseForm">
                    <div class="form-group">
                        <label>Your Response</label>
                        <textarea id="queryResponse" rows="5" required></textarea>
                    </div>
                    <div class="form-group">
                        <label>Status</label>
                        <select id="queryStatus">
                            <option value="pending">Pending</option>
                            <option value="resolved">Resolved</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">Send Response</button>
                </form>
            </div>
        </div>
    </div>

    <script src="js/script.js"></script>
    <script type="module" src="js/firebase-config.js"></script>
    <script type="module" src="js/auth.js"></script>
    <script type="module" src="js/retailer-dashboard.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js" integrity="sha512-BwHfrr4c9kmRkLw6iXFdzcdWV/PGkVgiIyIWLLlTSXzWQzxuSg4DiQUCpauz/EWjgk5TYQqX/kvn9pG1NpYfqg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="js/location-service.js"></script>
</body>
</html>
